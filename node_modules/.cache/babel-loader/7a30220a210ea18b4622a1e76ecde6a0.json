{"remainingRequest":"C:\\Users\\User\\Desktop\\UJmart\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\User\\Desktop\\UJmart\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\User\\Desktop\\UJmart\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\User\\Desktop\\UJmart\\src\\components\\ads\\picManage.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\User\\Desktop\\UJmart\\src\\components\\ads\\picManage.vue","mtime":1586436280733},{"path":"C:\\Users\\User\\Desktop\\UJmart\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\UJmart\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\UJmart\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\UJmart\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\User\\\\Desktop\\\\UJmart\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport _objectSpread from \"C:\\\\Users\\\\User\\\\Desktop\\\\UJmart\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapGetters, mapActions } from 'vuex';\nimport config from \"../../config/config\";\nimport vImage from 'v-lazy-image';\nimport vueGallery from 'vue-gallery-slideshow';\nimport { setTimeout } from 'timers';\nexport default {\n  name: \"adManage\",\n  data: function data() {\n    return {\n      urlBase: config.axiosConf.baseURL,\n      adv: {\n        name: null,\n        images: [],\n        _id: null\n      },\n      imagePaths: [],\n      images: [],\n      index: null,\n      imageTypes: [\"image/jpeg\", \"image/png\", \"image/gif\"],\n      axiosOpts: null\n    };\n  },\n  components: {\n    vueGallery: vueGallery,\n    vImage: vImage\n  },\n  methods: _objectSpread({}, mapActions(['getAd']), {\n    addPic: function addPic() {\n      var _this = this;\n\n      var file = this.$refs.files.files[0];\n      var typeError = false; // validate type\n\n      if (!this.imageTypes.includes(file.type)) {\n        //console.log(unverified)\n        typeError = true;\n      } // type error message\n\n\n      if (typeError) {\n        this.$toasted.error(\"Upload only valid images\", {\n          icon: \"times-circle\"\n        });\n      } else {\n        var fd = new FormData();\n        fd.append(\"image\", file, file.name);\n        var loader = this.$loading.show();\n        this.$axios.put(\"/ad/addpic/\" + this.$route.params.adId, fd, this.axiosOpts).then(function (res) {\n          loader.hide();\n\n          if (res.data.error) {\n            _this.$toasted.error(res.data.message, {\n              icon: \"times-circle\"\n            });\n          } else {\n            setTimeout(function () {\n              _this.images.push(res.data.image);\n\n              _this.imagePaths.push(config.axiosConf.baseURL + res.data.image.path);\n            }, 1000);\n\n            _this.$toasted.success(res.data.message, {\n              icon: \"check\"\n            });\n          }\n        }).catch(function (err) {\n          _this.$toasted.error(err, {\n            icon: \"times-circle\"\n          });\n\n          loader.hide();\n        });\n      }\n    },\n    init: function () {\n      var _init = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var i;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.getAd(this.$route.params.adId);\n\n              case 2:\n                _context.next = 4;\n                return this.ad;\n\n              case 4:\n                this.adv = _context.sent;\n                _context.next = 7;\n                return this.ad.images;\n\n              case 7:\n                this.images = _context.sent;\n                this.imagePaths = [];\n\n                for (i = 0; i < this.images.length; i++) {\n                  this.imagePaths.push(config.axiosConf.baseURL + this.images[i].path);\n                }\n\n              case 10:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function init() {\n        return _init.apply(this, arguments);\n      }\n\n      return init;\n    }(),\n    remPic: function () {\n      var _remPic = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2(image, index) {\n        var _this2 = this;\n\n        var loader;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                loader = this.$loading.show();\n                this.$axios.post(\"/ad/rempic/\" + this.$route.params.adId, {\n                  index: index,\n                  imgUrl: image.path\n                }, this.axiosOpts).then(function (res) {\n                  if (res.data.error) {\n                    _this2.$toasted.error(res.data.message, {\n                      icon: \"times-circle\"\n                    });\n                  } else {\n                    _this2.images.splice(index, 1);\n\n                    _this2.imagePaths.splice(index, 1);\n\n                    _this2.init();\n\n                    _this2.$toasted.success(res.data.message, {\n                      icon: \"check\"\n                    });\n                  }\n\n                  loader.hide();\n                }).catch(function (err) {\n                  loader.hide();\n\n                  _this2.$toasted.error(err, {\n                    icon: \"times-circle\"\n                  });\n                });\n\n              case 2:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function remPic(_x, _x2) {\n        return _remPic.apply(this, arguments);\n      }\n\n      return remPic;\n    }()\n  }),\n  computed: mapGetters(['ad', 'authInfo']),\n  created: function () {\n    var _created = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee3() {\n      var loader;\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              loader = this.$loading.show();\n              _context3.next = 3;\n              return this.init();\n\n            case 3:\n              this.axiosOpts = this.$headers();\n              loader.hide();\n\n            case 5:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, this);\n    }));\n\n    function created() {\n      return _created.apply(this, arguments);\n    }\n\n    return created;\n  }()\n};",{"version":3,"sources":["picManage.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  \n  <div>\n\n    <div class=\"purple p-2 mt-2 container\">\n      \n      <h5 class=\"white-text\">\n        <i class=\"fa fa-image d-inline\" aria-hidden=\"true\"></i>&nbsp;Pictures\n      </h5>\n\n      <div class=\"row\">\n        <div class=\"col m4 s6 p-0 px-3 my-2\" v-for=\"(image, i) in images\" :key=\"i\">\n\n          <div class=\"flex h-100 grad-4 border border-primary border-2\">\n            <!-- <img :src=\"imagePaths[i]\" :alt=\"image.name\" @click=\"index = i\"> -->\n            <vImage :src=\"imagePaths[i]\" />\n          </div>\n\n          <div class=\"rem\">\n            <button class=\"btn red\" @click=\"remPic(image, i)\"><i class=\"fa fa-trash\" aria-hidden=\"true\"></i></button>\n          </div>\n\n        </div>\n      </div>\n\n      <div class=\"orange p-2 center mb-2 darken-4\" v-if=\"images.length == 0\">\n        <p class=\"text-center\">\n          <i class=\"fa fa-images fa-3x\" aria-hidden=\"true\"></i>\n          <br> No Images\n        </p>\n      </div>\n\n\n      <!-- PICTURE -->\n      <div class=\"d-none\">\n        <input type=\"file\" class=\"form-control-file\" ref=\"files\" @change=\"addPic\">\n      </div>\n\n\n      <button class=\"btn btn-block orange my-2 darken-4\" @click=\"$refs.files.click()\" v-if=\"images.length < 6\">\n        <i class=\"fa fa-camera-retro\" aria-hidden=\"true\"></i> Add Picture\n      </button>\n\n      <!-- GALLERY COMPONENT -->\n      <vueGallery :images=\"imagePaths\" :index=\"index\" @close=\"index = null\"/>\n\n    </div>\n\n  </div>\n\n</template>\n\n<script>\nimport {mapGetters, mapActions} from 'vuex'\nimport config from '../../config/config'\nimport vImage from 'v-lazy-image'\nimport vueGallery from 'vue-gallery-slideshow'\nimport { setTimeout } from 'timers';\n\nexport default {\n\n  name: \"adManage\",\n\n  data(){\n    return {\n      \n      urlBase: config.axiosConf.baseURL,\n\n      adv: {\n        name: null,\n        images: [],\n        _id: null\n      },\n\n      imagePaths: [],\n\n      images: [],\n\n      index: null,\n\n      imageTypes: [\"image/jpeg\", \"image/png\", \"image/gif\"],\n\n      axiosOpts: null\n\n\n    }\n  },\n\n  components: {\n    vueGallery,\n    vImage\n  },\n\n  methods: {\n\n    ...mapActions(['getAd']),\n\n    addPic() {\n\n      let file = this.$refs.files.files[0]\n      let typeError = false\n\n      // validate type\n      if(!this.imageTypes.includes(file.type)) {\n        //console.log(unverified)\n        typeError = true\n      }\n\n      // type error message\n      if(typeError) {\n        this.$toasted.error(\"Upload only valid images\", {icon: \"times-circle\"})\n      } else {\n\n        let fd = new FormData\n        fd.append(\"image\", file, file.name)\n\n        let loader = this.$loading.show()\n\n        this.$axios.put(\"/ad/addpic/\"+this.$route.params.adId,fd, this.axiosOpts).then(res => {\n\n            loader.hide()\n\n            if(res.data.error) {\n              this.$toasted.error(res.data.message, {icon:\"times-circle\"})\n            } else {\n              \n              setTimeout(() => {\n                this.images.push(res.data.image)\n                this.imagePaths.push(config.axiosConf.baseURL+res.data.image.path)\n              }, 1000)\n\n              this.$toasted.success(res.data.message, {icon:\"check\"})\n            }\n          })\n          .catch(err => {\n            this.$toasted.error(err, {icon:\"times-circle\"})\n            loader.hide()\n          })\n      } \n\n    }, \n\n    async init() {\n      await this.getAd(this.$route.params.adId)\n      this.adv = await this.ad\n      this.images = await this.ad.images\n      this.imagePaths = []\n\n      for(let i = 0; i < this.images.length; i++) {\n        this.imagePaths.push(config.axiosConf.baseURL+this.images[i].path)\n      }\n    }, \n\n    async remPic(image, index) {\n\n      let loader = this.$loading.show()\n\n      this.$axios.post(\"/ad/rempic/\"+this.$route.params.adId, {index, imgUrl: image.path}, this.axiosOpts)\n        .then(res => {\n\n          if(res.data.error) {\n\n            this.$toasted.error(res.data.message, {icon: \"times-circle\"})\n\n          } else {\n\n            this.images.splice(index, 1)\n            this.imagePaths.splice(index, 1)\n            this.init()\n            this.$toasted.success(res.data.message, {icon: \"check\"})\n\n          }\n\n          loader.hide()\n\n        }).catch(err => {\n\n          loader.hide()\n\n          this.$toasted.error(err, {icon: \"times-circle\"})\n\n        })\n\n    }\n\n  },\n\n  computed: mapGetters(['ad', 'authInfo']),\n\n  async created() {\n    \n    let loader = this.$loading.show()\n    await this.init()\n    this.axiosOpts = this.$headers()\n    loader.hide()\n\n  }\n\n}\n</script>\n\n<style scoped>\n\n.flex img {\n    max-width: 99%;\n    max-height: 148.5px !important;\n}\n\n.flex {\n  height: 150px !important;\n  border: 2px #6e047c solid;\n}\n\n.rem {\n  z-index: 1000 !important;\n  position: relative;\n  top: 0px;\n  margin-bottom: 7px;\n}\n\n\n\n</style>\n"],"sourceRoot":"src/components/ads"}]}